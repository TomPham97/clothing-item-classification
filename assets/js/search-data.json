{
  
    
        "post0": {
            "title": "Title",
            "content": "It can be handy to create script files from notebooks, using nbdev&#39;s notebook2script. But since Kaggle doesn&#39;t actually save the notebook to the file-system, we have to do some workarounds to make this happen. Here&#39;s all the steps needed to export a notebook to a script: . !pip install -U nbdev . Collecting nbdev Downloading nbdev-2.0.7-py3-none-any.whl (49 kB) ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 49.2/49.2 KB 379.8 kB/s eta 0:00:00 Requirement already satisfied: astunparse in /opt/conda/lib/python3.7/site-packages (from nbdev) (1.6.3) Collecting fastcore&gt;=1.5.11 Downloading fastcore-1.5.11-py3-none-any.whl (69 kB) ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 69.1/69.1 KB 1.5 MB/s eta 0:00:00 Collecting execnb Downloading execnb-0.0.9-py3-none-any.whl (13 kB) Collecting ghapi Downloading ghapi-1.0.0-py3-none-any.whl (55 kB) ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 55.3/55.3 KB 1.8 MB/s eta 0:00:00 Collecting asttokens Downloading asttokens-2.0.5-py2.py3-none-any.whl (20 kB) Requirement already satisfied: packaging in /opt/conda/lib/python3.7/site-packages (from fastcore&gt;=1.5.11-&gt;nbdev) (21.3) Requirement already satisfied: pip in /opt/conda/lib/python3.7/site-packages (from fastcore&gt;=1.5.11-&gt;nbdev) (22.0.4) Requirement already satisfied: six in /opt/conda/lib/python3.7/site-packages (from asttokens-&gt;nbdev) (1.16.0) Requirement already satisfied: wheel&lt;1.0,&gt;=0.23.0 in /opt/conda/lib/python3.7/site-packages (from astunparse-&gt;nbdev) (0.37.1) Requirement already satisfied: ipython in /opt/conda/lib/python3.7/site-packages (from execnb-&gt;nbdev) (7.32.0) Requirement already satisfied: pexpect&gt;4.3 in /opt/conda/lib/python3.7/site-packages (from ipython-&gt;execnb-&gt;nbdev) (4.8.0) Requirement already satisfied: matplotlib-inline in /opt/conda/lib/python3.7/site-packages (from ipython-&gt;execnb-&gt;nbdev) (0.1.3) Requirement already satisfied: jedi&gt;=0.16 in /opt/conda/lib/python3.7/site-packages (from ipython-&gt;execnb-&gt;nbdev) (0.18.1) Requirement already satisfied: prompt-toolkit!=3.0.0,!=3.0.1,&lt;3.1.0,&gt;=2.0.0 in /opt/conda/lib/python3.7/site-packages (from ipython-&gt;execnb-&gt;nbdev) (3.0.27) Requirement already satisfied: setuptools&gt;=18.5 in /opt/conda/lib/python3.7/site-packages (from ipython-&gt;execnb-&gt;nbdev) (59.8.0) Requirement already satisfied: pygments in /opt/conda/lib/python3.7/site-packages (from ipython-&gt;execnb-&gt;nbdev) (2.11.2) Requirement already satisfied: traitlets&gt;=4.2 in /opt/conda/lib/python3.7/site-packages (from ipython-&gt;execnb-&gt;nbdev) (5.1.1) Requirement already satisfied: decorator in /opt/conda/lib/python3.7/site-packages (from ipython-&gt;execnb-&gt;nbdev) (5.1.1) Requirement already satisfied: backcall in /opt/conda/lib/python3.7/site-packages (from ipython-&gt;execnb-&gt;nbdev) (0.2.0) Requirement already satisfied: pickleshare in /opt/conda/lib/python3.7/site-packages (from ipython-&gt;execnb-&gt;nbdev) (0.7.5) Requirement already satisfied: pyparsing!=3.0.5,&gt;=2.0.2 in /opt/conda/lib/python3.7/site-packages (from packaging-&gt;fastcore&gt;=1.5.11-&gt;nbdev) (3.0.7) Requirement already satisfied: parso&lt;0.9.0,&gt;=0.8.0 in /opt/conda/lib/python3.7/site-packages (from jedi&gt;=0.16-&gt;ipython-&gt;execnb-&gt;nbdev) (0.8.3) Requirement already satisfied: ptyprocess&gt;=0.5 in /opt/conda/lib/python3.7/site-packages (from pexpect&gt;4.3-&gt;ipython-&gt;execnb-&gt;nbdev) (0.7.0) Requirement already satisfied: wcwidth in /opt/conda/lib/python3.7/site-packages (from prompt-toolkit!=3.0.0,!=3.0.1,&lt;3.1.0,&gt;=2.0.0-&gt;ipython-&gt;execnb-&gt;nbdev) (0.2.5) Installing collected packages: asttokens, fastcore, ghapi, execnb, nbdev Attempting uninstall: fastcore Found existing installation: fastcore 1.4.2 Uninstalling fastcore-1.4.2: Successfully uninstalled fastcore-1.4.2 ERROR: pip&#39;s dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts. fastai 2.6.0 requires fastcore&lt;1.5,&gt;=1.3.27, but you have fastcore 1.5.11 which is incompatible. Successfully installed asttokens-2.0.5 execnb-0.0.9 fastcore-1.5.11 ghapi-1.0.0 nbdev-2.0.7 WARNING: Running pip as the &#39;root&#39; user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv . . a=1 . %notebook -e testnbdev.ipynb . from nbdev.export import nb_export nb_export(&#39;testnbdev.ipynb&#39;, &#39;.&#39;) . !cat app.py . # AUTOGENERATED! DO NOT EDIT! File to edit: testnbdev.ipynb. # %% auto 0 __all__ = [&#39;a&#39;] # %% testnbdev.ipynb 2 a=1 .",
            "url": "https://tompham97.github.io/clothing-item-classification/2022/08/11/using-nbdev-export-in-a-kaggle-notebook.html",
            "relUrl": "/2022/08/11/using-nbdev-export-in-a-kaggle-notebook.html",
            "date": " • Aug 11, 2022"
        }
        
    
  
    
        ,"post1": {
            "title": "Title",
            "content": ". from fastai.vision.all import * from huggingface_hub import push_to_hub_fastai, from_pretrained_fastai import gradio as gr import skimage . ModuleNotFoundError Traceback (most recent call last) /Users/tompham/Document Files/Programming/GitHub/clothing-item-classification/_notebooks/2022-08-02-deploy-app.ipynb Cell 2 in &lt;cell line: 3&gt;() &lt;a href=&#39;vscode-notebook-cell:/Users/tompham/Document%20Files/Programming/GitHub/clothing-item-classification/_notebooks/2022-08-02-deploy-app.ipynb#ch0000001?line=0&#39;&gt;1&lt;/a&gt; #|export &lt;a href=&#39;vscode-notebook-cell:/Users/tompham/Document%20Files/Programming/GitHub/clothing-item-classification/_notebooks/2022-08-02-deploy-app.ipynb#ch0000001?line=1&#39;&gt;2&lt;/a&gt; from fastai.vision.all import * -&gt; &lt;a href=&#39;vscode-notebook-cell:/Users/tompham/Document%20Files/Programming/GitHub/clothing-item-classification/_notebooks/2022-08-02-deploy-app.ipynb#ch0000001?line=2&#39;&gt;3&lt;/a&gt; from huggingface_hub import push_to_hub_fastai, from_pretrained_fastai &lt;a href=&#39;vscode-notebook-cell:/Users/tompham/Document%20Files/Programming/GitHub/clothing-item-classification/_notebooks/2022-08-02-deploy-app.ipynb#ch0000001?line=3&#39;&gt;4&lt;/a&gt; import gradio as gr &lt;a href=&#39;vscode-notebook-cell:/Users/tompham/Document%20Files/Programming/GitHub/clothing-item-classification/_notebooks/2022-08-02-deploy-app.ipynb#ch0000001?line=4&#39;&gt;5&lt;/a&gt; import skimage ModuleNotFoundError: No module named &#39;huggingface_hub&#39; . title = &quot;Clothing item classifier&quot; description = &quot;A fastai model based classifer that can distinguish between shirts, pants, dresses, and socks.&quot; interpretation = &#39;default&#39; enable_queue = True . learn = from_pretrained_fastai(&quot;tompham97/clothe-classifier&quot;) labels = learn.dls.vocab . NameError Traceback (most recent call last) /Users/tompham/Document Files/Programming/GitHub/clothing-item-classification/_notebooks/2022-08-02-deploy-app.ipynb Cell 4 in &lt;cell line: 2&gt;() &lt;a href=&#39;vscode-notebook-cell:/Users/tompham/Document%20Files/Programming/GitHub/clothing-item-classification/_notebooks/2022-08-02-deploy-app.ipynb#ch0000003?line=0&#39;&gt;1&lt;/a&gt; #|export -&gt; &lt;a href=&#39;vscode-notebook-cell:/Users/tompham/Document%20Files/Programming/GitHub/clothing-item-classification/_notebooks/2022-08-02-deploy-app.ipynb#ch0000003?line=1&#39;&gt;2&lt;/a&gt; learn = from_pretrained_fastai(&#34;tompham97/clothe-classifier&#34;) &lt;a href=&#39;vscode-notebook-cell:/Users/tompham/Document%20Files/Programming/GitHub/clothing-item-classification/_notebooks/2022-08-02-deploy-app.ipynb#ch0000003?line=2&#39;&gt;3&lt;/a&gt; labels = learn.dls.vocab NameError: name &#39;from_pretrained_fastai&#39; is not defined . def classify_image(img): pred, idx, probs = learn.predict(img) return {labels[i]: float(probs[i]) for i in range(len(labels))} . image = gr.inputs.Image(shape=(192, 192)) label = gr.outputs.Label() examples = [&#39;dress.webp&#39;, &#39;pants.webp&#39;, &#39;shirt.jpeg&#39;, &#39;socks.jpeg&#39;] . intf = gr.Interface(fn=classify_image, inputs=image, outputs=label, title=title, description=description, examples=examples, interpretation=interpretation, enable_queue=enable_queue) intf.launch() . from nbdev.export import notebook2script notebook2script(&#39;app.ipynb&#39;) . ImportError Traceback (most recent call last) /Users/tompham/Document Files/Programming/GitHub/clothing-item-classification/_notebooks/2022-08-02-deploy-app.ipynb Cell 8 in &lt;cell line: 2&gt;() &lt;a href=&#39;vscode-notebook-cell:/Users/tompham/Document%20Files/Programming/GitHub/clothing-item-classification/_notebooks/2022-08-02-deploy-app.ipynb#ch0000007?line=0&#39;&gt;1&lt;/a&gt; import fastai -&gt; &lt;a href=&#39;vscode-notebook-cell:/Users/tompham/Document%20Files/Programming/GitHub/clothing-item-classification/_notebooks/2022-08-02-deploy-app.ipynb#ch0000007?line=1&#39;&gt;2&lt;/a&gt; from nbdev.export import notebook2script &lt;a href=&#39;vscode-notebook-cell:/Users/tompham/Document%20Files/Programming/GitHub/clothing-item-classification/_notebooks/2022-08-02-deploy-app.ipynb#ch0000007?line=2&#39;&gt;3&lt;/a&gt; notebook2script(&#39;app.ipynb&#39;) ImportError: cannot import name &#39;notebook2script&#39; from &#39;nbdev.export&#39; (/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/site-packages/nbdev/export.py) .",
            "url": "https://tompham97.github.io/clothing-item-classification/2022/08/02/deploy-app.html",
            "relUrl": "/2022/08/02/deploy-app.html",
            "date": " • Aug 2, 2022"
        }
        
    
  
    
        ,"post2": {
            "title": "Train a fastai model to recognize clothing items such as shirts, pants, socks, and dresses",
            "content": "# This code is only here to check that your internet is enabled. It doesn&#39;t do anything else. # Here&#39;s a help thread on getting your phone number verified: https://www.kaggle.com/product-feedback/135367 import socket,warnings try: socket.setdefaulttimeout(1) socket.socket(socket.AF_INET, socket.SOCK_STREAM).connect((&#39;1.1.1.1&#39;, 53)) except socket.error as ex: raise Exception(&quot;STOP: No internet. Click &#39;&gt;|&#39; in top right and set &#39;Internet&#39; switch to on&quot;) . Create categories and a data folder . clothe_types = &#39;shirt&#39;, &#39;pants&#39;, &#39;dress&#39;, &#39;socks&#39; path = Path(&#39;clothes&#39;) . if not path.exists(): path.mkdir() for o in clothe_types: dest = (path/o) dest.mkdir(exist_ok = True) results = search_images_ddg(f&#39;{o}&#39;) download_images(dest, urls=results) . fns = get_image_files(path) fns . (#591) [Path(&#39;clothes/dress/b5ac9ea6-87fb-4173-82d4-326138004cce.jpg&#39;),Path(&#39;clothes/dress/0435519e-a442-422a-8401-c46d3fd106c3.jpg&#39;),Path(&#39;clothes/dress/cd477bd9-aa97-40ba-9189-0cf46d211814.jpg&#39;),Path(&#39;clothes/dress/690eaed8-ded2-4e0c-b3c1-ef9b72ad4027.jpg&#39;),Path(&#39;clothes/dress/d866ee79-19d7-4932-940f-25e24049e6ea.jpg&#39;),Path(&#39;clothes/dress/87de9d66-73e3-402e-92e1-a0129d1d6203.jpg&#39;),Path(&#39;clothes/dress/6eaeeb1d-143f-4594-ad30-356359195955.jpg&#39;),Path(&#39;clothes/dress/bcc646fb-258f-4f39-828c-77007d3d776a.jpg&#39;),Path(&#39;clothes/dress/31dbf446-e338-4dab-bff6-06aaec0758b2.jpg&#39;),Path(&#39;clothes/dress/6a77e28e-ff9b-4952-9421-fdfb180a6da2.jpg&#39;)...] . Unlink files with broken urls . failed = verify_images(fns) failed . (#29) [Path(&#39;clothes/shirt/e81797ad-9dcc-44d5-81f7-1913b7d5d298.jpg&#39;),Path(&#39;clothes/shirt/423f8260-5a47-4429-81ac-47e1bc867a38.jpg&#39;),Path(&#39;clothes/shirt/bd49a72c-4202-4b5c-9592-7e9f37164d69.jpg&#39;),Path(&#39;clothes/shirt/7aea9759-c319-43bb-9208-9894f0715584.jpg&#39;),Path(&#39;clothes/shirt/c10951ed-2743-45ce-b381-50e036c090d3.jpg&#39;),Path(&#39;clothes/pants/e0c24d0d-45d9-402d-a309-f04c56dab26b.jpg&#39;),Path(&#39;clothes/pants/c88597d5-cba7-4e5a-8d94-3f5bec7b741f.jpg&#39;),Path(&#39;clothes/pants/df3cd9c6-3079-4eab-a413-31ef341eef3c.jpg&#39;),Path(&#39;clothes/pants/a2c001c4-9ccb-4013-9f94-9ecb8f80ba59.jpg&#39;),Path(&#39;clothes/pants/7505ecb2-5f60-495d-a190-569c89c56b70.jpg&#39;)...] . failed.map(Path.unlink) . (#29) [None,None,None,None,None,None,None,None,None,None...] . Create a datablock to import and split the data into train and test sets . clothe = DataBlock( blocks = (ImageBlock, CategoryBlock), get_items = get_image_files, splitter = RandomSplitter(valid_pct = 0.2, seed = 0), get_y = parent_label, item_tfms = Resize(128)) . Transform and augment the data . clothe = clothe.new( item_tfms = RandomResizedCrop(224, min_scale = 0.5), batch_tfms = aug_transforms()) dls = clothe.dataloaders(path) . Apply a fastai vision model to the data . See article by Jeremy Howard about which model is best for image classification . List of Pytorch image models . %%capture !pip install timm . import timm timm.list_models(&#39;convnext*&#39;) . [&#39;convnext_base&#39;, &#39;convnext_base_384_in22ft1k&#39;, &#39;convnext_base_in22ft1k&#39;, &#39;convnext_base_in22k&#39;, &#39;convnext_large&#39;, &#39;convnext_large_384_in22ft1k&#39;, &#39;convnext_large_in22ft1k&#39;, &#39;convnext_large_in22k&#39;, &#39;convnext_nano&#39;, &#39;convnext_nano_hnf&#39;, &#39;convnext_nano_ols&#39;, &#39;convnext_small&#39;, &#39;convnext_small_384_in22ft1k&#39;, &#39;convnext_small_in22ft1k&#39;, &#39;convnext_small_in22k&#39;, &#39;convnext_tiny&#39;, &#39;convnext_tiny_384_in22ft1k&#39;, &#39;convnext_tiny_hnf&#39;, &#39;convnext_tiny_in22ft1k&#39;, &#39;convnext_tiny_in22k&#39;, &#39;convnext_xlarge_384_in22ft1k&#39;, &#39;convnext_xlarge_in22ft1k&#39;, &#39;convnext_xlarge_in22k&#39;] . Select a model to use for training . learn = vision_learner(dls, resnet34, metrics = error_rate) learn.fine_tune(4) . Downloading: &#34;https://download.pytorch.org/models/resnet34-b627a593.pth&#34; to /root/.cache/torch/hub/checkpoints/resnet34-b627a593.pth . epoch train_loss valid_loss error_rate time . 0 | 1.736452 | 0.402375 | 0.125000 | 00:25 | . /root/mambaforge/lib/python3.9/site-packages/PIL/Image.py:992: UserWarning: Palette images with Transparency expressed in bytes should be converted to RGBA images warnings.warn( . epoch train_loss valid_loss error_rate time . 0 | 0.562999 | 0.346020 | 0.098214 | 00:26 | . 1 | 0.438043 | 0.349277 | 0.080357 | 00:26 | . 2 | 0.311372 | 0.299984 | 0.071429 | 00:26 | . 3 | 0.261189 | 0.276312 | 0.071429 | 00:26 | . /root/mambaforge/lib/python3.9/site-packages/PIL/Image.py:992: UserWarning: Palette images with Transparency expressed in bytes should be converted to RGBA images warnings.warn( /root/mambaforge/lib/python3.9/site-packages/PIL/Image.py:992: UserWarning: Palette images with Transparency expressed in bytes should be converted to RGBA images warnings.warn( /root/mambaforge/lib/python3.9/site-packages/PIL/Image.py:992: UserWarning: Palette images with Transparency expressed in bytes should be converted to RGBA images warnings.warn( /root/mambaforge/lib/python3.9/site-packages/PIL/Image.py:992: UserWarning: Palette images with Transparency expressed in bytes should be converted to RGBA images warnings.warn( . Investigate the performance of the model . interp = ClassificationInterpretation.from_learner(learn) interp.plot_confusion_matrix() . Data points with the highest losses . Either wrong results with high confidence or correct results with low confidence . interp.plot_top_losses(10, nrows = 2, figsize = (17,4)) . Clean the data . cleaner = ImageClassifierCleaner(learn) cleaner . /root/mambaforge/lib/python3.9/site-packages/PIL/Image.py:992: UserWarning: Palette images with Transparency expressed in bytes should be converted to RGBA images warnings.warn( . for idx in cleaner.delete(): cleaner.fns[idx].unlink() for idx, cat in cleaner.change(): shutil.move(str(cleaner.fns[idx]), path/cat) . Upload the model to HuggingFace hub . Install git-lfs, a dependency for uploading to the hub . !sudo apt-get install git-lfs !git lfs install . Reading package lists... Done Building dependency tree Reading state information... Done The following NEW packages will be installed: git-lfs 0 upgraded, 1 newly installed, 0 to remove and 66 not upgraded. Need to get 2129 kB of archives. After this operation, 7662 kB of additional disk space will be used. Get:1 http://archive.ubuntu.com/ubuntu bionic/universe amd64 git-lfs amd64 2.3.4-1 [2129 kB] Fetched 2129 kB in 1s (3165 kB/s) Selecting previously unselected package git-lfs. (Reading database ... 54953 files and directories currently installed.) Preparing to unpack .../git-lfs_2.3.4-1_amd64.deb ... Unpacking git-lfs (2.3.4-1) ... Setting up git-lfs (2.3.4-1) ... Processing triggers for man-db (2.8.3-2ubuntu0.1) ... Updated git hooks. Git LFS initialized. . Login into the hub with &#39;write&#39; token access . from huggingface_hub import notebook_login notebook_login() . from huggingface_hub import push_to_hub_fastai repo_id = &quot;tompham97/clothe-classifier&quot; push_to_hub_fastai(learner = learn, repo_id = repo_id) . ValueError Traceback (most recent call last) Input In [29], in &lt;cell line: 5&gt;() 1 from huggingface_hub import push_to_hub_fastai 3 repo_id = &#34;tompham97/clothe-classifier&#34; -&gt; 5 push_to_hub_fastai(learner = learn, repo_id = repo_id) File ~/mambaforge/lib/python3.9/site-packages/huggingface_hub/fastai_utils.py:410, in push_to_hub_fastai(learner, repo_id, commit_message, private, token, config, **kwargs) 407 token = HfFolder.get_token() 409 if token is None: --&gt; 410 raise ValueError( 411 &#34;You must login to the Hugging Face Hub. There are two options: &#34; 412 &#34;(1) Type `huggingface-cli login` in your terminal and enter your token. &#34; 413 &#34;(2) Enter your token in the `token` argument. &#34; 414 &#34;Your token is available in the Settings of your Hugging Face account. &#34; 415 ) 417 # Create repo using `HfApi()`. 418 repo_url = HfApi(endpoint=api_endpoint).create_repo( 419 repo_id, 420 token=token, (...) 423 exist_ok=True, 424 ) ValueError: You must login to the Hugging Face Hub. There are two options: (1) Type `huggingface-cli login` in your terminal and enter your token. (2) Enter your token in the `token` argument. Your token is available in the Settings of your Hugging Face account. .",
            "url": "https://tompham97.github.io/clothing-item-classification/2022/08/02/clothe-classifier-fastai-model.html",
            "relUrl": "/2022/08/02/clothe-classifier-fastai-model.html",
            "date": " • Aug 2, 2022"
        }
        
    
  

  
  

  
      ,"page1": {
          "title": "About Me",
          "content": "This website is powered by fastpages 1. . a blogging platform that natively supports Jupyter notebooks in addition to other formats. &#8617; . |",
          "url": "https://tompham97.github.io/clothing-item-classification/about/",
          "relUrl": "/about/",
          "date": ""
      }
      
  

  

  
  

  

  
  

  

  
  

  
  

  
  

  
      ,"page10": {
          "title": "",
          "content": "Sitemap: {{ “sitemap.xml” | absolute_url }} | .",
          "url": "https://tompham97.github.io/clothing-item-classification/robots.txt",
          "relUrl": "/robots.txt",
          "date": ""
      }
      
  

}